import os
import xml.etree.ElementTree as ET

def scan_manifest(manifest_path):
    try:
        tree = ET.parse(manifest_path)
        root = tree.getroot()
        
        vulnerabilities = []  
        
        for elem in root.iter():
            if "android:debuggable" in elem.attrib and elem.attrib["android:debuggable"] == "true":
                vulnerabilities.append("‚ö†Ô∏è Found android:debuggable=True in AndroidManifest.xml")
            if "android:allowBackup" in elem.attrib and elem.attrib["android:allowBackup"] == "true":
                vulnerabilities.append("‚ö†Ô∏è Found android:allowBackup=True in AndroidManifest.xml")
        
        if vulnerabilities:
            for vuln in vulnerabilities:
                print(vuln)
        else:
            print("‚úÖ No critical issues found in AndroidManifest.xml")

    except Exception as e:
        print(f"‚ùå Error scanning manifest: {e}")

def scan_apk(extracted_dir):
    print("üîç Scanning for vulnerabilities...")
    
    manifest_path = os.path.join(extracted_dir, "AndroidManifest.xml")
    if os.path.exists(manifest_path):
        scan_manifest(manifest_path)
    else:
        print("‚ùå AndroidManifest.xml not found!")
